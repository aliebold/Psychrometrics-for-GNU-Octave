# Copyright (C) 2022 Alexandre Umpierre
#
# This file is part of psychrometrics toolbox.
# psychrometrics toolbox is free software:
# you can redistribute it and/or modify it under the terms
# of the GNU General Public License (GPL) version 3
# as published by the Free Software Foundation.
#
# psychrometrics toolbox is distributed in the hope
# that it will be useful, but WITHOUT ANY WARRANTY;
# without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
# See the GNU General Public License for more details.
#
# You should have received a copy of the
# GNU General Public License along with this program
# (license GNU GPLv3.txt).
# It is also available at https://www.gnu.org/licenses/.

function doPlot()
    # Syntax:
    #
    # doPlot()
    #
    # doPlot plots
    #  a schematic psychrometric chart with
    #  previously computed curves with
    #  constant dry bulb temperature,
    #  constant specific volume,
    #  constant specific enthalpy and
    #  constant relative humidity.
    # Edition of this file is
    #  highly not recommended.
    # doPlot is an internal function of
    #  the psychrometrics toolbox for GNU Octave.
    figure;
    xlabel('Dry Bulb Temperature (K)');
    ylabel('Humidity (kg vapor / kg dry air)');
    axis([0+273.15 60+273.15 0 .03]);
    set(gca,...
        'fontsize',16,...
        'box','off',...
        'yaxislocation','right');

    u=[...
       2.7371e+02   3.6959e-03   2.7976e+02   5.8542e-03   2.8544e+02   8.7590e-03   2.9069e+02   1.2467e-02   2.9550e+02   1.6992e-02   2.9988e+02   2.2305e-02   3.0385e+02   2.8351e-02   3.0743e+02   3.5058e-02   3.1078e+02   4.2104e-02   3.1364e+02   5.0046e-02   3.1627e+02   5.8350e-02
       2.7412e+02   2.7678e-03   2.8042e+02   4.3804e-03   2.8644e+02   6.5462e-03   2.9215e+02   9.3039e-03   2.9752e+02   1.2657e-02   3.0257e+02   1.6580e-02   3.0731e+02   2.1023e-02   3.1176e+02   2.5928e-02   3.1604e+02   3.1052e-02   3.1852e+02   3.9756e-02   3.2049e+02   4.9390e-02
       2.7452e+02   1.8425e-03   2.8108e+02   2.9134e-03   2.8745e+02   4.3489e-03   2.9360e+02   6.1718e-03   2.9954e+02   8.3813e-03   3.0526e+02   1.0956e-02   3.1077e+02   1.3859e-02   3.1609e+02   1.7048e-02   3.2130e+02   2.0363e-02   3.2340e+02   2.9776e-02   3.2471e+02   4.0663e-02
       2.7493e+02   9.1987e-04   2.8174e+02   1.4533e-03   2.8845e+02   2.1669e-03   2.9506e+02   3.0707e-03   3.0156e+02   4.1626e-03   3.0795e+02   5.4301e-03   3.1423e+02   6.8534e-03   3.2043e+02   8.4089e-03   3.2656e+02   1.0017e-02   3.2827e+02   2.0092e-02   3.2893e+02   3.2160e-02
       2.7534e+02   9.7628e-10   2.8240e+02   1.5525e-09   2.8946e+02   2.3046e-09   2.9652e+02   3.2432e-09   3.0358e+02   4.4055e-09   3.1064e+02  -2.6980e-09   3.1770e+02   7.2252e-09   3.2476e+02   8.8338e-09   3.3182e+02   1.0499e-08   3.3315e+02   1.0692e-02   3.3315e+02   2.3873e-02];
    for i=1:size(u,2)/2
        hold on;plot(u(:,2*(i-1)+1),u(:,2*(i-1)+2),'-.g','color',[29/256 139/256 32/256],'linewidth',1.2);
    end
    text(286.8,.0180,'0.86 cu.m/kg','color','#1D8B20');
    text(282.0,.0135,'0.84 cu.m/kg','color','#1D8B20');

    u=[...
       2.7315e+02   3.7745e-03   2.7815e+02   5.4019e-03   2.8315e+02   7.6301e-03   2.8815e+02   1.0647e-02   2.9315e+02   1.4695e-02   2.9815e+02   2.0081e-02   3.0315e+02   2.7203e-02   3.0815e+02   3.6576e-02
       2.7550e+02   2.8260e-03   2.8149e+02   4.0414e-03   2.8785e+02   5.7024e-03   2.9468e+02   7.9465e-03   3.0211e+02   1.0947e-02   3.0690e+02   1.6369e-02   3.1065e+02   2.3962e-02   3.1440e+02   3.3815e-02
       2.7784e+02   1.8809e-03   2.8483e+02   2.6876e-03   2.9255e+02   3.7883e-03   3.0120e+02   5.2718e-03   3.1108e+02   7.2490e-03   3.1565e+02   1.2705e-02   3.1815e+02   2.0758e-02   3.2065e+02   3.1080e-02
       2.8019e+02   9.3903e-04   2.8818e+02   1.3406e-03   2.9724e+02   1.8876e-03   3.0773e+02   2.6231e-03   3.2004e+02   3.6004e-03   3.2440e+02   9.0893e-03   3.2565e+02   1.7590e-02   3.2690e+02   2.8371e-02
       2.8253e+02   4.3803e-07   2.9152e+02   1.6227e-07   3.0194e+02   3.2879e-08   3.1425e+02   1.0203e-09   3.2900e+02   1.9069e-10   3.3315e+02   5.5205e-03   3.3315e+02   1.4457e-02   3.3315e+02   2.5688e-02];
    for i=1:size(u,2)/2
        hold on;plot(u(:,2*(i-1)+1),u(:,2*(i-1)+2),'-b','linewidth',1.2);
    end
    text(293.3,.0205,'25 °C','color','b');
    text(298.3,.0275,'30 °C','color','b')

    u=[...
       2.7348e+02   3.8657e-03   2.7886e+02   5.6769e-03   2.8346e+02   7.7900e-03   2.8743e+02   1.0144e-02   2.9087e+02   1.2698e-02   2.9390e+02   1.5407e-02   2.9660e+02   1.8240e-02   2.9901e+02   2.1176e-02   3.0120e+02   2.4196e-02   3.0320e+02   2.7286e-02   3.0505e+02   3.0430e-02   3.0673e+02   3.3633e-02   3.0830e+02   3.6878e-02
       2.7588e+02   2.8941e-03   2.8240e+02   4.2465e-03   2.8833e+02   5.8215e-03   2.9380e+02   7.5724e-03   2.9886e+02   9.4678e-03   3.0362e+02   1.1473e-02   3.0573e+02   1.4530e-02   3.0755e+02   1.7698e-02   3.0919e+02   2.0927e-02   3.1069e+02   2.4209e-02   3.1207e+02   2.7529e-02   3.1334e+02   3.0893e-02   3.1451e+02   3.4288e-02
       2.7828e+02   1.9260e-03   2.8594e+02   2.8236e-03   2.9321e+02   3.8671e-03   3.0017e+02   5.0248e-03   3.0686e+02   6.2753e-03   3.1335e+02   7.5951e-03   3.1487e+02   1.0869e-02   3.1608e+02   1.4263e-02   3.1718e+02   1.7697e-02   3.1818e+02   2.1164e-02   3.1910e+02   2.4657e-02   3.1994e+02   2.8179e-02   3.2072e+02   3.1721e-02
       2.8069e+02   9.6128e-04   2.8949e+02   1.4081e-03   2.9809e+02   1.9267e-03   3.0654e+02   2.5008e-03   3.1486e+02   3.1195e-03   3.2307e+02   3.7711e-03   3.2401e+02   7.2559e-03   3.2462e+02   1.0869e-02   3.2516e+02   1.4503e-02   3.2566e+02   1.8152e-02   3.2612e+02   2.1814e-02   3.2655e+02   2.5491e-02   3.2694e+02   2.9177e-02
       2.8309e+02   8.4156e-10   2.9303e+02   1.2313e-09   3.0297e+02   1.8221e-09   3.1291e+02   2.3621e-09   3.2285e+02   2.9441e-09   3.3279e+02   3.5544e-09   3.3315e+02   3.6898e-03   3.3315e+02   7.5174e-03   3.3315e+02   1.1345e-02   3.3315e+02   1.5173e-02   3.3315e+02   1.9000e-02   3.3315e+02   2.2828e-02   3.3315e+02   2.6655e-02];
    for i=1:size(u,2)/2
        hold on;plot(u(:,2*(i-1)+1),u(:,2*(i-1)+2),'-.r','linewidth',1.2);
    end
    text(273,.0065,'20 kJ/kg','color','r');
    text(277,.0084,'30 kJ/kg','color','r');

    u=[...
       2.7315e+02   3.7745e-03   2.7315e+02   3.0159e-03   2.7315e+02   2.2592e-03   2.7315e+02   1.5043e-03
       2.7631e+02   4.7411e-03   2.7631e+02   3.7871e-03   2.7631e+02   2.8360e-03   2.7631e+02   1.8878e-03
       2.7947e+02   5.9232e-03   2.7947e+02   4.7295e-03   2.7947e+02   3.5404e-03   2.7947e+02   2.3558e-03
       2.8262e+02   7.3620e-03   2.8262e+02   5.8757e-03   2.8262e+02   4.3964e-03   2.8262e+02   2.9240e-03
       2.8578e+02   9.1059e-03   2.8578e+02   7.2634e-03   2.8578e+02   5.4317e-03   2.8578e+02   3.6106e-03
       2.8894e+02   1.1211e-02   2.8894e+02   8.9366e-03   2.8894e+02   6.6785e-03   2.8894e+02   4.4364e-03
       2.9210e+02   1.3743e-02   2.9210e+02   1.0946e-02   2.9210e+02   8.1737e-03   2.9210e+02   5.4253e-03
       2.9526e+02   1.6779e-02   2.9526e+02   1.3351e-02   2.9526e+02   9.9600e-03   2.9526e+02   6.6047e-03
       2.9841e+02   2.0409e-02   2.9841e+02   1.6221e-02   2.9841e+02   1.2087e-02   2.9841e+02   8.0059e-03
       3.0157e+02   2.4738e-02   3.0157e+02   1.9634e-02   3.0157e+02   1.4610e-02   3.0157e+02   9.6644e-03
       3.0473e+02   2.9891e-02   3.0473e+02   2.3685e-02   3.0473e+02   1.7596e-02   3.0473e+02   1.1621e-02
       3.0789e+02   3.6016e-02   3.0789e+02   2.8483e-02   3.0789e+02   2.1120e-02   3.0789e+02   1.3923e-02
       3.1104e+02   4.3291e-02   3.1104e+02   3.4157e-02   3.1104e+02   2.5271e-02   3.1104e+02   1.6622e-02
       3.1420e+02   5.1928e-02   3.1420e+02   4.0860e-02   3.1420e+02   3.0150e-02   3.1420e+02   1.9780e-02
       3.1736e+02   6.2188e-02   3.1736e+02   4.8775e-02   3.1736e+02   3.5878e-02   3.1736e+02   2.3467e-02
       3.2052e+02   7.4390e-02   3.2052e+02   5.8122e-02   3.2052e+02   4.2596e-02   3.2052e+02   2.7764e-02
       3.2368e+02   8.8933e-02   3.2368e+02   6.9168e-02   3.2368e+02   5.0473e-02   3.2368e+02   3.2762e-02
       3.2683e+02   1.0632e-01   3.2683e+02   8.2244e-02   3.2683e+02   5.9709e-02   3.2683e+02   3.8572e-02
       3.2999e+02   1.2720e-01   3.2999e+02   9.7760e-02   3.2999e+02   7.0548e-02   3.2999e+02   4.5319e-02
       3.3315e+02   1.5242e-01   3.3315e+02   1.1624e-01   3.3315e+02   8.3286e-02   3.3315e+02   5.3152e-02];
    for i=1:size(u,2)/2
        hold on;plot(u(:,2*(i-1)+1),u(:,2*(i-1)+2),'-k','linewidth',1.2);
    end
    text(308,.028,'80 %','color','k');
    text(313.2,.028,'60 %','color','k');
    text(321,.028,'40 %','color','k');

    u=[...
       2.7315e+02   1.1275e-03   2.7315e+02   9.3934e-04   2.7315e+02   7.5125e-04   2.7315e+02   5.6326e-04   2.7315e+02   3.7540e-04   2.7315e+02   1.8764e-04
       2.7631e+02   1.4148e-03   2.7631e+02   1.1785e-03   2.7631e+02   9.4247e-04   2.7631e+02   7.0659e-04   2.7631e+02   4.7088e-04   2.7631e+02   2.3535e-04
       2.7947e+02   1.7652e-03   2.7947e+02   1.4703e-03   2.7947e+02   1.1757e-03   2.7947e+02   8.8134e-04   2.7947e+02   5.8728e-04   2.7947e+02   2.9350e-04
       2.8262e+02   2.1905e-03   2.8262e+02   1.8243e-03   2.8262e+02   1.4586e-03   2.8262e+02   1.0933e-03   2.8262e+02   7.2844e-04   2.8262e+02   3.6401e-04
       2.8578e+02   2.7040e-03   2.8578e+02   2.2517e-03   2.8578e+02   1.8001e-03   2.8578e+02   1.3491e-03   2.8578e+02   8.9874e-04   2.8578e+02   4.4905e-04
       2.8894e+02   3.3214e-03   2.8894e+02   2.7654e-03   2.8894e+02   2.2103e-03   2.8894e+02   1.6563e-03   2.8894e+02   1.1032e-03   2.8894e+02   5.5111e-04
       2.9210e+02   4.0602e-03   2.9210e+02   3.3798e-03   2.9210e+02   2.7009e-03   2.9210e+02   2.0235e-03   2.9210e+02   1.3475e-03   2.9210e+02   6.7303e-04
       2.9526e+02   4.9404e-03   2.9526e+02   4.1116e-03   2.9526e+02   3.2849e-03   2.9526e+02   2.4604e-03   2.9526e+02   1.6381e-03   2.9526e+02   8.1799e-04
       2.9841e+02   5.9851e-03   2.9841e+02   4.9796e-03   2.9841e+02   3.9773e-03   2.9841e+02   2.9782e-03   2.9841e+02   1.9823e-03   2.9841e+02   9.8959e-04
       3.0157e+02   7.2203e-03   3.0157e+02   6.0053e-03   3.0157e+02   4.7950e-03   3.0157e+02   3.5893e-03   3.0157e+02   2.3883e-03   3.0157e+02   1.1918e-03
       3.0473e+02   8.6754e-03   3.0473e+02   7.2127e-03   3.0473e+02   5.7568e-03   3.0473e+02   4.3076e-03   3.0473e+02   2.8651e-03   3.0473e+02   1.4293e-03
       3.0789e+02   1.0384e-02   3.0789e+02   8.6292e-03   3.0789e+02   6.8843e-03   3.0789e+02   5.1490e-03   3.0789e+02   3.4232e-03   3.0789e+02   1.7069e-03
       3.1104e+02   1.2384e-02   3.1104e+02   1.0286e-02   3.1104e+02   8.2015e-03   3.1104e+02   6.1309e-03   3.1104e+02   4.0739e-03   3.1104e+02   2.0303e-03
       3.1420e+02   1.4718e-02   3.1420e+02   1.2217e-02   3.1420e+02   9.7354e-03   3.1420e+02   7.2731e-03   3.1420e+02   4.8299e-03   3.1420e+02   2.4056e-03
       3.1736e+02   1.7436e-02   3.1736e+02   1.4462e-02   3.1736e+02   1.1516e-02   3.1736e+02   8.5975e-03   3.1736e+02   5.7054e-03   3.1736e+02   2.8397e-03
       3.2052e+02   2.0593e-02   3.2052e+02   1.7067e-02   3.2052e+02   1.3579e-02   3.2052e+02   1.0129e-02   3.2052e+02   6.7160e-03   3.2052e+02   3.3400e-03
       3.2368e+02   2.4252e-02   3.2368e+02   2.0080e-02   3.2368e+02   1.5961e-02   3.2368e+02   1.1894e-02   3.2368e+02   7.8793e-03   3.2368e+02   3.9148e-03
       3.2683e+02   2.8487e-02   3.2683e+02   2.3559e-02   3.2683e+02   1.8706e-02   3.2683e+02   1.3925e-02   3.2683e+02   9.2144e-03   3.2683e+02   4.5733e-03
       3.2999e+02   3.3381e-02   3.2999e+02   2.7571e-02   3.2999e+02   2.1863e-02   3.2999e+02   1.6254e-02   3.2999e+02   1.0743e-02   3.2999e+02   5.3253e-03
       3.3315e+02   3.9030e-02   3.3315e+02   3.2188e-02   3.3315e+02   2.5487e-02   3.3315e+02   1.8921e-02   3.3315e+02   1.2488e-02   3.3315e+02   6.1817e-03];
    for i=1:size(u,2)/2
        hold on;plot(u(:,2*(i-1)+1),u(:,2*(i-1)+2),'color','#4B4B4B','linewidth',1.2);
    end
    text(326.6,.028,'30 %','color','#4B4B4B');
    text(328.6,.0255,'25 %','color','#4B4B4B');
    text(328.6,.020,'20 %','color','#4B4B4B');
    text(328.6,.015,'15 %','color','#4B4B4B');
    text(328.6,.0098,'10 %','color','#4B4B4B');
    text(328.6,.0046,'5 %','color','#4B4B4B');
end
